task "default" do
  this_dir = File.dirname(__FILE__)
  message = ENV["message"].to_s
  should_push = message != ""
  have_pushed = false

  puts "Copying dotfiles.."
  %w(vimrc tmux.conf gemrc).each do |dotfile|
    print "Processing #{dotfile} ...".ljust(40, '.')
    system "cp -f ~/.#{dotfile} #{this_dir}/.#{dotfile}"
    puts "✓"
  end


  if should_push
    system "git add ./"
    system "git commit -m '#{message}'"
    system "git push origin master"
    have_pushed = true
  end

  if have_pushed
    puts "-" * 60
    puts "☑ Committed and pushed to server with message:"
    puts "  - #{message}"
  end
  puts "-" * 60
  puts "☺ Yehey! ☺".rjust(60, " ")
end
